(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function o(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=o(s);fetch(s.href,a)}})();const A="https://yee.mfleon32.workers.dev",C=10,n=(e,t=document)=>t.querySelector(e),u=e=>{const t=n("#toast");t.textContent=e,t.hidden=!1,setTimeout(()=>t.hidden=!0,3500)},v=e=>{if(!e)return null;const t=e.trim().replace(/\s*#\s*/,"#"),o=t.indexOf("#");if(o<1)return null;const r=t.slice(0,o).trim(),s=t.slice(o+1).replace(/\s+/g,"").toUpperCase();return/^[A-Z0-9]{2,5}$/.test(s)?{gameName:r,tagLine:s,riotId:`${r}#${s}`}:null},g=e=>(e*100).toFixed(1)+"%",c=(e,t=1)=>Number(e||0).toFixed(t),P=(e=0)=>{const t=Math.floor(e/60),o=Math.floor(e%60);return`${t}:${String(o).padStart(2,"0")}`};async function w(e,t,o=C){const r=new URL("/v1/profile",A);r.searchParams.set("riotId",e),r.searchParams.set("platform",t),r.searchParams.set("count",String(o));const s=await fetch(r,{headers:{Accept:"application/json"}});if(!s.ok){let a="";try{const i=await s.json();a=(i==null?void 0:i.message)||(i==null?void 0:i.error)||""}catch{}throw new Error(`API ${s.status}${a?" "+a:""}`)}return s.json()}const d=(e,t,o="")=>`<div class="kpi"><div class="val ${o}">${t}</div><div class="hint">${e}</div></div>`;function b(e){var p,l,f,m,h,L,k,S;const t=((p=e.recent)==null?void 0:p.summary)||{wins:0,losses:0,kills:0,deaths:0,assists:0,avgCS:0},o=t.wins+t.losses||1,r=g((t.wins||0)/((t.wins||0)+(t.losses||0)||1)),s=t.deaths?c((t.kills+t.assists)/t.deaths,2):"∞",a=(((f=(l=e.ranks)==null?void 0:l.solo)==null?void 0:f.tier)||"UNRANKED")+((h=(m=e.ranks)==null?void 0:m.solo)!=null&&h.rank?" "+e.ranks.solo.rank:""),i=((k=(L=e.ranks)==null?void 0:L.solo)==null?void 0:k.lp)!=null?`${e.ranks.solo.lp} LP`:"";return`<div class="card">
        <div class="title">${e.name||e.gameName} <span class="pill">${e.riotId}</span></div>
        <div class="kpis">
          ${d("솔로랭크",`${a} ${i}`)}
          ${d("레벨",((S=e.summoner)==null?void 0:S.summonerLevel)??"-")}
          ${d("승률",r,t.wins>=t.losses?"ok":"bad")}
          ${d("KDA",s)}
          ${d("평균 K",c(t.kills/o,1))}
          ${d("평균 D",c(t.deaths/o,1))}
          ${d("평균 A",c(t.assists/o,1))}
          ${d("평균 CS",c(t.avgCS,1))}
        </div></div>`}function R(e){var o;return`<div class="card">
        <div class="title">최근 경기 샘플</div>
        <table class="table"><thead><tr><th>매치ID</th><th>결과</th><th>K/D/A</th><th>CS</th><th>시간</th></tr></thead>
        <tbody>${(((o=e.recent)==null?void 0:o.sample)||[]).map(r=>`<tr>
        <td>${r.matchId}</td><td>${r.win?"W":"L"}</td><td>${r.k}/${r.d}/${r.a}</td><td>${r.cs}</td><td>${P(r.dur)}</td>
      </tr>`).join("")||'<tr><td colspan="5">데이터 없음</td></tr>'}</tbody></table>
      </div>`}function T(e){const t=n("#sResult");t.innerHTML="",t.insertAdjacentHTML("beforeend",b(e)),t.insertAdjacentHTML("beforeend",R(e))}function U(e,t){var f,m;const o=n("#cResult");o.innerHTML="",o.insertAdjacentHTML("beforeend",b(e)),o.insertAdjacentHTML("beforeend",b(t));const r=((f=e.recent)==null?void 0:f.summary)||{},s=((m=t.recent)==null?void 0:m.summary)||{},a=(r.wins||0)+(r.losses||0)||1,i=(s.wins||0)+(s.losses||0)||1,p=[["승률",g((r.wins||0)/a),g((s.wins||0)/i)],["KDA",r.deaths?c(((r.kills||0)+(r.assists||0))/r.deaths,2):"∞",s.deaths?c(((s.kills||0)+(s.assists||0))/s.deaths,2):"∞"],["평균 K/D/A",`${c((r.kills||0)/a,1)} / ${c((r.deaths||0)/a,1)} / ${c((r.assists||0)/a,1)}`,`${c((s.kills||0)/i,1)} / ${c((s.deaths||0)/i,1)} / ${c((s.assists||0)/i,1)}`],["평균 CS",c(r.avgCS||0,1),c(s.avgCS||0,1)],["표본 수",a,i]],l=document.createElement("div");l.className="card",l.innerHTML=`<div class="title">상세 비교</div>
        <table class="table"><thead><tr><th>지표</th><th>${e.riotId}</th><th>${t.riotId}</th></tr></thead>
        <tbody>${p.map(h=>`<tr><td>${h[0]}</td><td>${h[1]}</td><td>${h[2]}</td></tr>`).join("")}</tbody></table>`,o.parentElement.appendChild(l)}async function y(){const e=v(n("#sId").value),t=n("#sPlatform").value;if(!e){u("Riot ID 형식 오류. 예: Faker#KR1");return}n("#searchBtn").disabled=!0;try{const o=await w(e.riotId,t);T(o),history.replaceState(null,"",`#search=${encodeURIComponent(e.riotId)}&p=${t}`)}catch(o){console.error(o),u(String(o.message||o))}finally{n("#searchBtn").disabled=!1}}async function I(){const e=v(n("#idA").value),t=v(n("#idB").value),o=n("#platform").value;if(!e||!t){u("두 Riot ID를 모두 입력");return}n("#compare").disabled=!0;try{const[r,s]=await Promise.all([w(e.riotId,o),w(t.riotId,o)]);U(r,s),history.replaceState(null,"",`#compare=${encodeURIComponent(e.riotId)}|${encodeURIComponent(t.riotId)}&p=${o}`)}catch(r){console.error(r),u(String(r.message||r))}finally{n("#compare").disabled=!1}}function $(e){const t=e==="search";n("#view-search").hidden=!t,n("#view-compare").hidden=t,n("#tab-search").classList.toggle("active",t),n("#tab-compare").classList.toggle("active",!t)}function D(){const e=location.hash.slice(1);if(e){if(e.startsWith("compare=")){$("compare");const t=decodeURIComponent(e.split("=")[1].split("&")[0]||""),[o,r]=t.split("|"),s=new URLSearchParams(e.split("&").slice(1).join("&")).get("p")||"kr";o&&r&&(n("#idA").value=o,n("#idB").value=r,n("#platform").value=s,I())}else if(e.startsWith("search=")){$("search");const t=decodeURIComponent(e.split("=")[1].split("&")[0]||""),o=new URLSearchParams(e.split("&").slice(1).join("&")).get("p")||"kr";t&&(n("#sId").value=t,n("#sPlatform").value=o,y())}}}document.addEventListener("click",e=>{const t=e.target.id;if(t==="searchBtn"&&y(),t==="compare"&&I(),t==="tab-search"&&$("search"),t==="tab-compare"&&$("compare"),t==="share")try{navigator.clipboard.writeText(location.href),u("링크를 복사했습니다")}catch{u("복사 실패")}});document.addEventListener("keydown",e=>{e.key==="Enter"&&(n("#view-search").hidden?I():y())});window.addEventListener("DOMContentLoaded",D);

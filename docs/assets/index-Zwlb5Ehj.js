(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();const b="https://yee.mfleon32.workers.dev",A=10,c=(t,e=document)=>e.querySelector(t),h=t=>{const e=c("#toast");e.textContent=t,e.hidden=!1,setTimeout(()=>e.hidden=!0,3500)},k=t=>{if(!t)return null;const e=t.trim().replace(/\s*#\s*/,"#"),r=e.indexOf("#");if(r<1)return null;const o=e.slice(0,r).trim(),s=e.slice(r+1).replace(/\s+/g,"").toUpperCase();return/^[A-Z0-9]{2,5}$/.test(s)?{gameName:o,tagLine:s,riotId:`${o}#${s}`}:null},$=t=>(t*100).toFixed(1)+"%",a=(t,e=1)=>Number(t||0).toFixed(e);async function I(t,e,r=A){const o=new URL("/v1/profile",b);o.searchParams.set("riotId",t),o.searchParams.set("platform",e),o.searchParams.set("count",String(r));const s=await fetch(o,{headers:{Accept:"application/json"}});if(!s.ok){let n="";try{const i=await s.json();n=(i==null?void 0:i.message)||(i==null?void 0:i.error)||""}catch{}throw new Error(`API ${s.status}${n?" "+n:""}`)}return await s.json()}function l(t,e,r=""){return`<div class="kpi"><div class="val ${r}">${e}</div><div class="hint">${t}</div></div>`}function L(t){var p,d,m,f,u,g,w,y;const e=((p=t.recent)==null?void 0:p.summary)||{wins:0,losses:0,kills:0,deaths:0,assists:0,avgCS:0},r=e.wins+e.losses||1,o=$((e.wins||0)/((e.wins||0)+(e.losses||0)||1)),s=e.deaths?a((e.kills+e.assists)/e.deaths,2):"∞",n=(((m=(d=t.ranks)==null?void 0:d.solo)==null?void 0:m.tier)||"UNRANKED")+((u=(f=t.ranks)==null?void 0:f.solo)!=null&&u.rank?" "+t.ranks.solo.rank:""),i=((w=(g=t.ranks)==null?void 0:g.solo)==null?void 0:w.lp)!=null?`${t.ranks.solo.lp} LP`:"";return`
        <div class="card">
          <div class="title">${t.name||t.gameName} <span class="pill">${t.riotId}</span></div>
          <div class="kpis">
            ${l("솔로랭크",`${n} ${i}`)}
            ${l("레벨",((y=t.summoner)==null?void 0:y.summonerLevel)??"-")}
            ${l("승률",o,e.wins>=e.losses?"ok":"bad")}
            ${l("KDA",s)}
            ${l("평균 K",a(e.kills/r,1))}
            ${l("평균 D",a(e.deaths/r,1))}
            ${l("평균 A",a(e.assists/r,1))}
            ${l("평균 CS",a(e.avgCS,1))}
          </div>
        </div>`}function C(t,e){var m,f;const r=c("#result");r.innerHTML="",r.insertAdjacentHTML("beforeend",L(t)),r.insertAdjacentHTML("beforeend",L(e));const o=((m=t.recent)==null?void 0:m.summary)||{},s=((f=e.recent)==null?void 0:f.summary)||{},n=(o.wins||0)+(o.losses||0)||1,i=(s.wins||0)+(s.losses||0)||1,p=[["승률",$((o.wins||0)/n),$((s.wins||0)/i)],["KDA",o.deaths?a(((o.kills||0)+(o.assists||0))/o.deaths,2):"∞",s.deaths?a(((s.kills||0)+(s.assists||0))/s.deaths,2):"∞"],["평균 K/D/A",`${a((o.kills||0)/n,1)} / ${a((o.deaths||0)/n,1)} / ${a((o.assists||0)/n,1)}`,`${a((s.kills||0)/i,1)} / ${a((s.deaths||0)/i,1)} / ${a((s.assists||0)/i,1)}`],["평균 CS",a(o.avgCS||0,1),a(s.avgCS||0,1)],["표본 수",n,i]],d=document.createElement("div");d.className="card",d.innerHTML=`
        <div class="title">상세 비교</div>
        <table class="table">
          <thead><tr><th>지표</th><th>${t.riotId}</th><th>${e.riotId}</th></tr></thead>
          <tbody>
            ${p.map(u=>`<tr><td>${u[0]}</td><td>${u[1]}</td><td>${u[2]}</td></tr>`).join("")}
          </tbody>
        </table>`,r.parentElement.appendChild(d)}async function v(){const t=k(c("#idA").value),e=k(c("#idB").value),r=c("#platform").value;if(!t||!e){h("두 Riot ID를 모두 입력하세요. 예: Faker#KR1");return}c("#compare").disabled=!0;try{const[o,s]=await Promise.all([I(t.riotId,r),I(e.riotId,r)]);C(o,s),history.replaceState(null,"",`#compare=${encodeURIComponent(t.riotId)}|${encodeURIComponent(e.riotId)}&p=${r}`)}catch(o){console.error(o),h(String(o.message||o))}finally{c("#compare").disabled=!1}}function S(){const t=location.hash.slice(1);if(!t.startsWith("compare="))return;const e=decodeURIComponent(t.split("=")[1].split("&")[0]||""),[r,o]=e.split("|"),s=new URLSearchParams(t.split("&").slice(1).join("&")).get("p")||"kr";r&&o&&(c("#idA").value=r,c("#idB").value=o,c("#platform").value=s,v())}document.addEventListener("click",t=>{const e=t.target.id;if(e==="compare"&&v(),e==="share")try{navigator.clipboard.writeText(location.href),h("링크를 복사했습니다")}catch{h("복사 실패")}});document.addEventListener("keydown",t=>{t.key==="Enter"&&v()});window.addEventListener("DOMContentLoaded",S);
